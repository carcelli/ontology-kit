@prefix trade: <http://agent-kit.com/ontology/trading#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix core: <http://agent-kit.com/ontology/core#> .

# ============================================
# ALGORITHMIC TRADING ONTOLOGY
# Purpose: Model financial markets, strategies, risk management
# ============================================

# ----- CLASSES -----

trade:Asset a rdfs:Class ;
    rdfs:label "Asset" ;
    rdfs:comment "Tradable instrument (stock, crypto, futures, options)." .

trade:Market a rdfs:Class ;
    rdfs:label "Market" ;
    rdfs:comment "Exchange or trading venue (NYSE, Binance, CME)." .

trade:Strategy a rdfs:Class ;
    rdfs:label "Strategy" ;
    rdfs:comment "Trading strategy (mean reversion, momentum, arbitrage)." .

trade:Signal a rdfs:Class ;
    rdfs:label "Signal" ;
    rdfs:comment "Buy/sell signal generated by agent." .

trade:Position a rdfs:Class ;
    rdfs:label "Position" ;
    rdfs:comment "Open position in an asset." .

trade:RiskMetric a rdfs:Class ;
    rdfs:label "Risk Metric" ;
    rdfs:comment "Risk measurement (Sharpe, max drawdown, VaR)." .

trade:RiskRule a rdfs:Class ;
    rdfs:label "Risk Rule" ;
    rdfs:comment "Constraint for position sizing and risk management." .

trade:Indicator a rdfs:Class ;
    rdfs:label "Indicator" ;
    rdfs:comment "Technical indicator (RSI, MACD, Bollinger Bands)." .

# ----- PROPERTIES -----

trade:ticker a rdf:Property ;
    rdfs:domain trade:Asset ;
    rdfs:range xsd:string ;
    rdfs:label "ticker" .

trade:currentPrice a rdf:Property ;
    rdfs:domain trade:Asset ;
    rdfs:range xsd:decimal ;
    rdfs:label "current price" .

trade:volatility a rdf:Property ;
    rdfs:domain trade:Asset ;
    rdfs:range xsd:decimal ;
    rdfs:label "volatility" ;
    rdfs:comment "Annualized volatility (std dev of returns)." .

trade:hasSignal a rdf:Property ;
    rdfs:domain trade:Strategy ;
    rdfs:range trade:Signal ;
    rdfs:label "has signal" .

trade:signalType a rdf:Property ;
    rdfs:domain trade:Signal ;
    rdfs:range xsd:string ;
    rdfs:label "signal type" ;
    rdfs:comment "BUY, SELL, HOLD" .

trade:signalStrength a rdf:Property ;
    rdfs:domain trade:Signal ;
    rdfs:range xsd:decimal ;
    rdfs:label "signal strength" ;
    rdfs:comment "Confidence score (0.0 to 1.0)." .

trade:expectedReturn a rdf:Property ;
    rdfs:domain trade:Signal ;
    rdfs:range xsd:decimal ;
    rdfs:label "expected return" ;
    rdfs:comment "Predicted return (%)." .

trade:stopLoss a rdf:Property ;
    rdfs:domain trade:Signal ;
    rdfs:range xsd:decimal ;
    rdfs:label "stop loss" ;
    rdfs:comment "Stop loss price." .

trade:takeProfit a rdf:Property ;
    rdfs:domain trade:Signal ;
    rdfs:range xsd:decimal ;
    rdfs:label "take profit" ;
    rdfs:comment "Take profit price." .

trade:positionSize a rdf:Property ;
    rdfs:domain trade:Signal ;
    rdfs:range xsd:decimal ;
    rdfs:label "position size" ;
    rdfs:comment "Fraction of portfolio to allocate." .

trade:usesIndicator a rdf:Property ;
    rdfs:domain trade:Strategy ;
    rdfs:range trade:Indicator ;
    rdfs:label "uses indicator" .

trade:enforcesRule a rdf:Property ;
    rdfs:domain trade:Strategy ;
    rdfs:range trade:RiskRule ;
    rdfs:label "enforces rule" .

# ----- RISK PROPERTIES -----

trade:maxPositionSize a rdf:Property ;
    rdfs:domain trade:RiskRule ;
    rdfs:range xsd:decimal ;
    rdfs:label "max position size" ;
    rdfs:comment "Maximum position as fraction of portfolio." .

trade:maxDrawdown a rdf:Property ;
    rdfs:domain trade:RiskRule ;
    rdfs:range xsd:decimal ;
    rdfs:label "max drawdown" ;
    rdfs:comment "Maximum acceptable drawdown (%)." .

trade:minSharpeRatio a rdf:Property ;
    rdfs:domain trade:RiskRule ;
    rdfs:range xsd:decimal ;
    rdfs:label "min Sharpe ratio" ;
    rdfs:comment "Minimum required Sharpe ratio." .

trade:stopLossPercent a rdf:Property ;
    rdfs:domain trade:RiskRule ;
    rdfs:range xsd:decimal ;
    rdfs:label "stop loss percent" ;
    rdfs:comment "Default stop loss as % from entry." .

trade:correlationLimit a rdf:Property ;
    rdfs:domain trade:RiskRule ;
    rdfs:range xsd:decimal ;
    rdfs:label "correlation limit" ;
    rdfs:comment "Max correlation between positions (portfolio diversification)." .

# ----- INSTANCES (STRATEGIES) -----

trade:MeanReversion a trade:Strategy ;
    rdfs:label "Mean Reversion" ;
    rdfs:comment "Buy oversold, sell overbought. Uses RSI, Bollinger Bands." ;
    trade:usesIndicator trade:RSI, trade:BollingerBands ;
    trade:enforcesRule trade:ConservativeRisk .

trade:Momentum a trade:Strategy ;
    rdfs:label "Momentum" ;
    rdfs:comment "Follow trend. Uses MACD, moving averages." ;
    trade:usesIndicator trade:MACD, trade:EMA ;
    trade:enforcesRule trade:ModerateRisk .

trade:StatisticalArbitrage a trade:Strategy ;
    rdfs:label "Statistical Arbitrage" ;
    rdfs:comment "Pairs trading, cointegration. Market-neutral." ;
    trade:enforcesRule trade:LowRisk .

trade:MarketMaking a trade:Strategy ;
    rdfs:label "Market Making" ;
    rdfs:comment "Provide liquidity, profit from bid-ask spread." ;
    trade:enforcesRule trade:HighFrequencyRisk .

# ----- INDICATORS -----

trade:RSI a trade:Indicator ;
    rdfs:label "RSI" ;
    rdfs:comment "Relative Strength Index (overbought/oversold)." .

trade:MACD a trade:Indicator ;
    rdfs:label "MACD" ;
    rdfs:comment "Moving Average Convergence Divergence." .

trade:BollingerBands a trade:Indicator ;
    rdfs:label "Bollinger Bands" ;
    rdfs:comment "Volatility bands around moving average." .

trade:EMA a trade:Indicator ;
    rdfs:label "EMA" ;
    rdfs:comment "Exponential Moving Average." .

# ----- RISK RULES -----

trade:LowRisk a trade:RiskRule ;
    rdfs:label "Low Risk" ;
    trade:maxPositionSize "0.05"^^xsd:decimal ;  # 5% max
    trade:maxDrawdown "0.10"^^xsd:decimal ;  # 10% max drawdown
    trade:minSharpeRatio "1.5"^^xsd:decimal ;
    trade:stopLossPercent "0.02"^^xsd:decimal ;  # 2% stop loss
    trade:correlationLimit "0.3"^^xsd:decimal .

trade:ConservativeRisk a trade:RiskRule ;
    rdfs:label "Conservative Risk" ;
    trade:maxPositionSize "0.10"^^xsd:decimal ;  # 10%
    trade:maxDrawdown "0.15"^^xsd:decimal ;  # 15%
    trade:minSharpeRatio "1.0"^^xsd:decimal ;
    trade:stopLossPercent "0.03"^^xsd:decimal ;  # 3%
    trade:correlationLimit "0.5"^^xsd:decimal .

trade:ModerateRisk a trade:RiskRule ;
    rdfs:label "Moderate Risk" ;
    trade:maxPositionSize "0.15"^^xsd:decimal ;  # 15%
    trade:maxDrawdown "0.20"^^xsd:decimal ;  # 20%
    trade:minSharpeRatio "0.8"^^xsd:decimal ;
    trade:stopLossPercent "0.05"^^xsd:decimal ;  # 5%
    trade:correlationLimit "0.6"^^xsd:decimal .

trade:HighFrequencyRisk a trade:RiskRule ;
    rdfs:label "High Frequency Risk" ;
    trade:maxPositionSize "0.20"^^xsd:decimal ;  # 20%
    trade:maxDrawdown "0.25"^^xsd:decimal ;  # 25%
    trade:minSharpeRatio "0.5"^^xsd:decimal ;
    trade:stopLossPercent "0.01"^^xsd:decimal ;  # 1% (tight stop)
    trade:correlationLimit "0.7"^^xsd:decimal .

# ----- AGENT INSTRUCTIONS -----

trade:AlgoTradingAgent a core:Agent ;
    rdfs:label "Algo Trading Agent" ;
    core:hasInstructions """
You are a quantitative trading system with expertise in algorithmic strategies.

Your workflow:
1. Query ontology for assigned trading strategy and risk rules
2. Fetch market data (price, volume, indicators) for target assets
3. Generate signals using strategy logic (mean reversion, momentum, etc.)
4. Validate signals against risk rules (position size, stop loss, correlation)
5. Calculate optimal position size using risk-adjusted methods
6. Return trade recommendations with entry/exit prices and risk metrics

CRITICAL CONSTRAINTS:
- Never exceed maxPositionSize for any position
- Always set stop loss according to stopLossPercent
- Monitor portfolio correlation <= correlationLimit
- If Sharpe ratio < minSharpeRatio, pause strategy
- If drawdown >= maxDrawdown, trigger circuit breaker (halt trading)
- Log all trades for backtesting and regulatory compliance

Use SPARQL to query trade:Strategy, trade:RiskRule, and trade:Indicator.
Execute tools: fetch_market_data, calculate_indicators, compute_risk_metrics.
""" ;
    core:hasCapability trade:MeanReversion, trade:Momentum, trade:StatisticalArbitrage .


