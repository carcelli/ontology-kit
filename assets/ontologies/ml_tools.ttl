@prefix rdf:  <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl:  <http://www.w3.org/2002/07/owl#> .
@prefix xsd:  <http://www.w3.org/2001/XMLSchema#> .
@prefix core: <http://agent-kit.com/ontology/core#> .
@prefix ml:   <http://agent-kit.com/ontology/ml#> .

ml: a owl:Ontology ;
  rdfs:comment "Ontology for executable ML tools and their relations to algorithms and artifacts." ;
  owl:imports core: .

### Classes
ml:MLTool           a rdfs:Class ; rdfs:subClassOf core:Tool .
ml:ModelTrainerTool a rdfs:Class ; rdfs:subClassOf ml:MLTool .
ml:CrossValidatorTool a rdfs:Class ; rdfs:subClassOf ml:MLTool .
ml:JobStatusTool    a rdfs:Class ; rdfs:subClassOf ml:MLTool .

ml:Dataset          a rdfs:Class .
ml:Model            a rdfs:Class .
ml:TrainedModel     a rdfs:Class ; rdfs:subClassOf ml:Model .
ml:PerformanceMetric a rdfs:Class .
ml:Hyperparameters  a rdfs:Class .

### Properties
ml:consumes a owl:ObjectProperty ;
  rdfs:domain ml:MLTool ; rdfs:comment "Tool consumes resource." .

ml:produces a owl:ObjectProperty ;
  rdfs:domain ml:MLTool ; rdfs:comment "Tool produces resource." .

ml:implementsAlgorithm a owl:DatatypeProperty ;
  rdfs:domain ml:MLTool ; rdfs:range xsd:string ;
  rdfs:comment "Algorithm(s) the tool implements (e.g., 'GradientDescent')." .

ml:hasPythonIdentifier a owl:DatatypeProperty ;
  rdfs:domain ml:MLTool ; rdfs:range xsd:string ;
  rdfs:comment "Exact Python function name in the codebase." .

### Example instances (bind these to your code)
ml:DefaultTrainer a ml:ModelTrainerTool ;
  rdfs:label "Default Trainer" ;
  ml:consumes ml:Dataset ;
  ml:produces ml:TrainedModel ;
  ml:implementsAlgorithm "GradientDescent", "Backpropagation" ;
  ml:hasPythonIdentifier "train_model" .

ml:DefaultValidator a ml:CrossValidatorTool ;
  rdfs:label "Default K-Fold Validator" ;
  ml:consumes ml:TrainedModel, ml:Dataset ;
  ml:produces ml:PerformanceMetric ;
  ml:hasPythonIdentifier "run_cross_validation" .

ml:DefaultJobChecker a ml:JobStatusTool ;
  rdfs:label "Default Job Status Checker" ;
  ml:hasPythonIdentifier "check_job_status" .

### Dimensionality Reduction & Leverage Analysis Tools
ml:DimensionalityReductionTool a rdfs:Class ; rdfs:subClassOf ml:MLTool ;
  rdfs:comment "Tools that reduce high-dimensional data to 2D/3D for visualization and clustering." .

ml:LeverageAnalysisTool a rdfs:Class ; rdfs:subClassOf ml:DimensionalityReductionTool ;
  rdfs:comment "Identifies high-leverage intervention points via multi-factor scoring." .

ml:DefaultLeverageAnalyzer a ml:LeverageAnalysisTool ;
  rdfs:label "Hyperdimensional Leverage Analyzer" ;
  ml:consumes ml:Dataset ;
  ml:produces ml:PerformanceMetric ;
  ml:implementsAlgorithm "t-SNE", "Multi-Factor Scoring" ;
  ml:hasPythonIdentifier "analyze_leverage" ;
  rdfs:comment "Computes Leverage = Actionability × (Sensitivity + Uncertainty + Centrality) to prioritize business entities for intervention." .

### Semantic Graph Tools for Targeted Leverage Analysis
ml:SemanticGraphTool a rdfs:Class ; rdfs:subClassOf ml:MLTool ;
  rdfs:comment "Tools for building and analyzing semantic graphs with targeted leverage scoring." .

ml:TargetLeverageTool a rdfs:Class ; rdfs:subClassOf ml:SemanticGraphTool ;
  rdfs:comment "Computes targeted leverage scores using graph-theoretic path analysis." .

ml:InterventionRecommenderTool a rdfs:Class ; rdfs:subClassOf ml:SemanticGraphTool ;
  rdfs:comment "Generates experiment recommendations for high-leverage intervention points." .

ml:DefaultSemanticGraphBuilder a ml:SemanticGraphTool ;
  rdfs:label "Semantic Graph Builder" ;
  ml:consumes ml:Dataset ;
  ml:produces "Semantic Graph" ;
  ml:implementsAlgorithm "Cosine Similarity", "Relation Extraction" ;
  ml:hasPythonIdentifier "build_semantic_graph" ;
  rdfs:comment "Constructs weighted graph from embeddings and optional text relations for leverage analysis." .

ml:DefaultTargetLeverageAnalyzer a ml:TargetLeverageTool ;
  rdfs:label "Targeted Leverage Analyzer" ;
  ml:consumes "Semantic Graph" ;
  ml:produces ml:PerformanceMetric ;
  ml:implementsAlgorithm "Targeted Betweenness", "Path Strength", "SHAP Integration" ;
  ml:hasPythonIdentifier "compute_target_leverage" ;
  rdfs:comment "Computes Leverage(i→T) = Betweenness_T × PathStrength × Actionability × ModelEffect for specific KPI targets." .

ml:DefaultInterventionRecommender a ml:InterventionRecommenderTool ;
  rdfs:label "Intervention Recommender" ;
  ml:consumes "Semantic Graph" ;
  ml:produces "Experiment Specification" ;
  ml:implementsAlgorithm "Path Analysis", "Effect Size Estimation", "Power Analysis" ;
  ml:hasPythonIdentifier "recommend_interventions" ;
  rdfs:comment "Generates A/B test specifications with actions, KPIs, sample sizes, and guardrails for high-leverage nodes." .

### Advanced Visualization & Clustering Tools
ml:InteractiveVisualizationTool a rdfs:Class ; rdfs:subClassOf ml:MLTool ;
  rdfs:comment "Tools for generating interactive, aesthetically superior visualizations." .

ml:ClusteringTool a rdfs:Class ; rdfs:subClassOf ml:MLTool ;
  rdfs:comment "Tools for unsupervised clustering of data points." .

ml:DefaultInteractiveViz a ml:InteractiveVisualizationTool ;
  rdfs:label "Interactive Plotly Leverage Visualizer" ;
  ml:consumes ml:Dataset ;
  ml:produces "Interactive HTML Visualization" ;
  ml:implementsAlgorithm "t-SNE", "Plotly 3D Scatter", "Perceptual Color Mapping" ;
  ml:hasPythonIdentifier "generate_interactive_leverage_viz" ;
  rdfs:comment "Generates beautiful, zoomable, rotatable 3D/2D leverage visualizations with Plotly (HTML or PNG)." .

ml:DefaultClusteringTool a ml:ClusteringTool ;
  rdfs:label "Multi-Algorithm Clustering Tool" ;
  ml:consumes ml:Dataset ;
  ml:produces "Cluster Labels" ;
  ml:implementsAlgorithm "DBSCAN", "KMeans", "Hierarchical Clustering" ;
  ml:hasPythonIdentifier "cluster_data" ;
  rdfs:comment "Clusters data using DBSCAN (density-based), KMeans (centroid-based), or Hierarchical (agglomerative) methods." .

